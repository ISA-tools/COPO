{% extends 'copo/base.html' %}

{% load staticfiles %}
{% load web_tags %}

{% block stylesheet_block %}
	<link rel="stylesheet" href="{% static 'copo/css/copo/browse_style.css' %}">
	<link rel="stylesheet" href="{% static 'copo/css/copo/study.css' %}">

{% endblock %}


{% block title_block %} Study {% endblock %}

{% block tagline_block %}{% endblock %}

{% block breadcrumb_block %}
	<ol class="breadcrumb">
		<li><a href="{% url 'copo:index' %}">Home</a></li>
		<li class="active"><a href="{% url 'copo:view_profile' profile_id=profile_id %}">Profile</a></li>
	</ol>
{% endblock %}


{% block browse_header_block %}

	<div id="browse_header">
        <span class="blue_icon">
           <a><i class="fa fa-plus-circle" data-toggle="modal" data-target="#newStudyModal"></i></a>
        </span>
        <span class="blue_icon">
            <a><i class="fa fa-pencil-square-o"></i></a>
        </span>
        <span class="blue_icon">
            <a><i class="fa fa-trash-o"></i></a>
        </span>

		<div class="input-group input-group-sm">
            <span class="input-group-addon">
                <i class="fa fa-search"></i>
            </span>
			<input type="search" class="form-control" placeholder="Search">
		</div>
	</div>

{% endblock %}

{% block work_area %}

	<!-- here is the markup for the top table data pulled in from the study itself -->
	<table id="browse_table">
		<h2 class="h2">{{ profile_title }}</h2>
        {{ profile_abstract }}
		<hr/>
		<h3>Collections</h3>
		<tr>
			<th>Name</th>
			<th>Type</th>
		</tr>

		{% for c in collections %}

			<tr>
				<td data-collection_id="{{ c.id }}"><a href="{% url 'copo:view_collection' collection_id=c|mongo_id %}">{{ c.name }}</a></td>

				<td>{{ c.type }}</td>
			</tr>

		{% endfor %}

	</table>

	<!-- subsequently we should loop and have some sort of collapsable table showing the existing work collections -->


	<!-- then we have a button to add a new work collection and a submit to Repo button-->
	<ul class="list-inline pull-right" id="bottom_button_group">
		<li>
			<button type="button" class="btn btn-primary btn-lg text-center" data-toggle="modal"
					data-target="#newCollectionModal">Add Collection
			</button>
		</li>
		<li>
			<button type="button" class="btn btn-primary btn-lg" id="submit_to_repo_btn">Submit to Repositories</button>
		</li>
	</ul>

    <!-- this is a temporary placement of this snippet. Will figure out the correct order of things from FS.-->
    <br />
    <p>
    <form id="frm_initiate_repo" action="{% url 'copo:initiate_repo' %}" method="post">
        {% csrf_token %}
        <button type="button" id="frm_initiate_button"  class="btn btn-primary" autocomplete="off">
            Initiate submission
        </button>
    </form>
    <br/>
    <div id="repo-feedback-cnt-1" class="progress">
        <div id="repo-feedback-1" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 5%">
            <span id="repo-feedback-span-1">45% Complete</span>
        </div>
    </div>
    <div id="repo-alert-cnt-1" class="alert alert-success alert-dismissible" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <span id="repo-alert-span-1"><strong>Success!</strong></span>
    </div>
    <!-- end of temporary -->

	<!-- here is the hidden modal which will be populated from js, will look at having a rest call to a python service to
    query the forms xml for the type of data selected by the user -->

	<!-- Modal -->
	<div class="modal fade" id="newCollectionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
		 aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span
							aria-hidden="true">&times;</span><span
							class="sr-only">Close</span></button>
					<h4 class="modal-title" id="myModalLabel">New Collection</h4>
				</div>
				<div class="modal-body">

					<form role="form" id="ena_study_form" action="{% url 'copo:new_collection' %}" method="post">
						{% csrf_token %}

						<input type="hidden" name="profile_id" value="{{ profile_id }}">

						<div class="form-group">
							<label for="collection_name">Collection Name</label><br/>
							<input type="text" name="collection_name" id="collection_name" class="form_control"
								   placeholder="Enter Name"/>
						</div>


						<div class="form-group">
							<label for="collection_type">Colection Type</label>
							<select name="collection_type" id="collection_type" class="form-control">
								<option>ENA Submission</option>
								<option>PDF File</option>
								<option>Image</option>
								<option>Movie</option>
								<option>Other</option>
							</select>
						</div>

						<button type="submit" class="btn btn-default">Submit</button>

					</form>

				</div>
				<div class="modal-footer">

				</div>
			</div>
		</div>
	</div>




{% endblock %}


{% block js_block %}
    <script src="{% static 'copo/js/profile.js' %}"></script>
    <script src="{% static 'copo/js/repojs.js' %}"></script>
{% endblock %}